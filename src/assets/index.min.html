<!doctype html><html lang=en><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=description content="Grafito log viewer"><link rel=stylesheet href=pico.min.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Chivo&family=Chivo+Mono&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel=stylesheet><link rel=icon href=favicon.svg type=image/svg+xml><link rel=stylesheet href=style.min.css><title>Grafito Log Viewer</title><script src=htmx.org@1.9.10.js></script><body hx-get=services hx-target=#unit-suggestions hx-trigger=load hx-swap=innerHTML><dialog id=global-error-dialog><article><header><a href=#close aria-label=Close class=close onclick='return this.closest("dialog").close(),!1'></a>Network Error</header><div id=global-error-dialog-content></div><footer><form method=dialog style=margin-bottom:0><button class=secondary>Close</button></form></footer></article></dialog><div id=page-content-layout class=container-fluid><button id=toggle-sidebar-btn class=secondary aria-expanded=true aria-controls=filters-sidebar title="Hide Filters Sidebar">
<span class=material-icons style=vertical-align:middle>menu</span></button><aside id=filters-sidebar><hgroup class=sidebar-header-info style=text-align:right><h1><a href=https://grafito.ralsina.me class=grafito-title-link>Grafito</a></h1><span>A simple log viewer</span></hgroup><hr><div class=search-container-wrapper><input type=search id=search-box placeholder="Search logs..." title="Enter text to search in log messages (uses journalctl -g)" hx-get=logs hx-trigger="keyup changed delay:500ms" hx-target=#results name=q class=log-filter hx-indicator=#loading-spinner hx-include=.log-filter></div><div><input id=unit-filter name=unit list=unit-suggestions placeholder="Unit (e.g., docker)" title="Filter logs by systemd unit (e.g., nginx)" hx-get=logs hx-trigger="keyup delay:500ms, change delay:500ms, immediateUnitFilterUpdate" hx-target=#results class=log-filter hx-indicator=#loading-spinner hx-include=.log-filter></div><div><input id=tag-filter name=tag placeholder="Syslog Tag (e.g., myapp)" title="Filter logs by syslog identifier (tag)" hx-get=logs hx-trigger="keyup changed delay:500ms" hx-target=#results class=log-filter hx-indicator=#loading-spinner hx-include=.log-filter></div><div><input id=hostname-filter name=hostname placeholder="Hostname (e.g., server1)" title="Filter logs by hostname (_HOSTNAME)" hx-get=logs hx-trigger="keyup changed delay:500ms" hx-target=#results class=log-filter hx-indicator=#loading-spinner hx-include=.log-filter></div><div><select id=time-range-filter name=since hx-get=logs title="Filter logs by time range" hx-trigger=change hx-target=#results class=log-filter hx-indicator=#loading-spinner hx-include=.log-filter><option value>Any time<option value=-15m>Last 15 minutes<option value=-1h>Last 1 hour<option value=-1d>Last 24 hours<option value=-7d>Last week<option value=-1M>Last month<option value=-3M>Last 3 months<option value=-1y>Last year</select></div><div><select id=priority-filter name=priority hx-get=logs title="Filter logs by priority level" hx-trigger=change hx-target=#results class=log-filter hx-indicator=#loading-spinner hx-include=.log-filter><option value=0>Emergency<option value=1>Alert<option value=2>Critical<option value=3>Error<option value=4>Warning<option value=5 selected>Notice<option value=6>Informational<option value=7>Debug</select></div><div class=sidebar-actions-area><div class=sidebar-buttons-row><button id=show-command-button class=secondary aria-label="Show equivalent command" title="Show equivalent journalctl command" hx-get=command hx-include=.log-filter hx-trigger=click hx-swap=none hx-on:htmx:after-request="if(event.detail.successful) alert('These filters are the equivalent of: ' + event.detail.xhr.responseText); else alert('Error fetching command: ' + event.detail.xhr.statusText + '\\nCheck console for more details.');">
<span class=material-icons style=vertical-align:middle>help_outline</span>
</button>
<button id=clear-filters-btn class=secondary title="Clear all filters">
<span class=material-icons style=vertical-align:middle>clear</span>
</button>
<button id=copy-link-button class=secondary aria-label="Copy shareable link" title="Copy link with current filters" onclick=copyShareableLink()>
<span class=material-icons style=vertical-align:middle>link</span>
</button>
<button id=export-logs-button class=secondary aria-label="Export logs" title="Export current logs as text" onclick=exportLogsAsText()>
<span class=material-icons style=vertical-align:middle>save_alt</span></button><div class=live-view-controls><label for=live-view title="Toggle live log updates every 10 seconds"><input type=checkbox id=live-view name=live-view role=switch class=log-filter hx-get=logs hx-target=#results hx-indicator=#loading-spinner>
Live</label></div></div></div><datalist id=unit-suggestions></datalist><footer class=container-fluid><a href=https://links.ralsina.me style=text-decoration:none><span class=material-icons style=vertical-align:middle>directions_run</span>
Roberto Alsina</a>
<span>| </span><a href=https://grafito.ralsina.me><span class=material-icons style=vertical-align:middle>home</span></a>
<span>| </span><a href=https://github.com/ralsina/grafito><span class=material-icons style=vertical-align:middle>code</span></a><hr><div class=theme-switch-wrapper><label for=theme-switch title="Toggle light/dark mode"><input type=checkbox id=theme-switch name=theme role=switch>
<span class=material-icons style=vertical-align:middle>dark_mode</span>
<span class=material-icons style=vertical-align:middle>light_mode</span></label></div></footer></aside><main><div id=loading-spinner class=htmx-indicator><div>Loading...
<span aria-busy=true></span></div></div><div id=live-view-poller hx-get=logs hx-trigger="every 10s[document.getElementById('live-view').checked]" hx-target=#results hx-include=.log-filter></div><div id=results hx-get=logs hx-trigger="initial-load-event from:body" hx-indicator=#loading-spinner hx-include=.log-filter hx-target=this></div></main></div><dialog id=details-dialog><article><header><a href=#close aria-label=Close class=close onclick='return this.closest("dialog").close(),!1'></a>Log Entry Details</header><div id=details-dialog-content style=max-height:70vh;overflow-y:auto></div><template id=details-dialog-loading-spinner-template><div style=text-align:center;padding:2em><span aria-busy=true>Loading details...</span></div></template><footer><form method=dialog style=margin-bottom:0><button class=secondary>Close</button></form></footer></article></dialog><script>const SHARED_FILTER_CONFIGS=[{id:"search-box",param:"q",type:"value"},{id:"unit-filter",param:"unit",type:"value"},{id:"tag-filter",param:"tag",type:"value"},{id:"hostname-filter",param:"hostname",type:"value"},{id:"time-range-filter",param:"since",type:"select"},{id:"priority-filter",param:"priority",type:"select"},{id:"live-view",param:"live-view",type:"checkbox",trueValue:"on"}];document.addEventListener("DOMContentLoaded",function(){const s=document.getElementById("global-error-dialog"),i=document.getElementById("global-error-dialog-content");s&&i&&document.body.addEventListener("htmx:afterRequest",function(e){if(e.detail.error){console.error("HTMX Request Failed. Details:",e.detail);let t=e.detail.error.message||"Failed to send request";i.innerHTML=`
                <p role="alert" style="border: 1px solid var(--pico-form-element-invalid-border-color); background-color: var(--pico-form-element-invalid-background-color); color: var(--pico-color); padding: 1em; margin-bottom:0;">
                  <strong>Details:</strong> ${t}
                </p>`,s.open||s.showModal()}else e.detail.successful&&(s.open&&(s.close(),i.innerHTML=""),updateBrowserURL())});const t=document.getElementById("theme-switch"),l=document.documentElement;function o(e){e==="dark"?(l.setAttribute("data-theme","dark"),t&&(t.checked=!0)):(l.setAttribute("data-theme","light"),t&&(t.checked=!1)),localStorage.setItem("theme",e)}const c=localStorage.getItem("theme");c?o(c):o(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),t&&t.addEventListener("change",function(){o(this.checked?"dark":"light")});const r=new URLSearchParams(window.location.search);SHARED_FILTER_CONFIGS.forEach(e=>{const t=document.getElementById(e.id);if(r.has(e.param)&&t){const n=r.get(e.param);e.type==="value"?t.value=n:e.type==="select"?Array.from(t.options).some(e=>e.value===n)&&(t.value=n):e.type==="checkbox"&&(t.checked=n===e.trueValue)}});const e=document.getElementById("toggle-sidebar-btn"),n=document.getElementById("filters-sidebar"),d=document.querySelector("main"),u="Show Filters Sidebar",h="Hide Filters Sidebar";function a(t){if(!n||!e||!d){console.error("Required elements for sidebar toggle not found.");return}const s=n.offsetWidth;t?(n.classList.add("collapsed"),e.setAttribute("aria-expanded","false"),e.setAttribute("title",u)):(n.classList.remove("collapsed"),e.setAttribute("aria-expanded","true"),e.setAttribute("title",h))}if(e&&n){e.addEventListener("click",()=>{const e=n.classList.contains("collapsed");a(!e),localStorage.setItem("sidebarCollapsed",!e)});const t=document.getElementById("clear-filters-btn");t&&t.addEventListener("click",function(){document.getElementById("search-box").value="",document.getElementById("unit-filter").value="",document.getElementById("tag-filter").value="",document.getElementById("hostname-filter").value="",document.getElementById("time-range-filter").value="",document.getElementById("priority-filter").value="5";const e=document.getElementById("live-view");e.checked&&(e.checked=!1,htmx.trigger(e,"change")),htmx.trigger(document.body,"initial-load-event",{}),updateBrowserURL()});const s=localStorage.getItem("sidebarCollapsed");a(s!==null&&s==="true"),htmx.trigger(document.body,"initial-load-event",{})}});function buildFilterURLSearchParams(){const e=new URLSearchParams;return SHARED_FILTER_CONFIGS.forEach(t=>{const n=document.getElementById(t.id);n&&(t.type==="checkbox"?n.checked&&e.set(t.param,t.trueValue):n.value&&e.set(t.param,n.value))}),e}function updateBrowserURL(){const n=buildFilterURLSearchParams();let e=n.toString();const t=e?window.location.origin+window.location.pathname+"?"+e:window.location.origin+window.location.pathname;window.history.replaceState({path:t},"",t)}function copyShareableLink(){const t=buildFilterURLSearchParams(),e=window.location.origin+window.location.pathname+"?"+t.toString();window.isSecureContext&&navigator.clipboard?navigator.clipboard.writeText(e).then(()=>alert("Link copied to clipboard!")).catch(e=>alert("Failed to copy link: "+e)):alert(`Shareable Link (copy manually):

`+e)}function exportLogsAsText(){const t=new URLSearchParams;SHARED_FILTER_CONFIGS.forEach(e=>{if(e.param==="live-view")return;const n=document.getElementById(e.id);n&&(e.type==="checkbox"?n.checked&&t.set(e.param,e.trueValue):n.value&&t.set(e.param,n.value))}),t.set("format","text");const n="/logs?"+t.toString(),e=document.createElement("a");e.href=n,e.setAttribute("download","grafito-logs.txt"),document.body.appendChild(e),e.click(),document.body.removeChild(e)}function setUnitFilterAndTrigger(e){const t=document.getElementById("unit-filter");return t&&(t.value=e,htmx.trigger(t,"immediateUnitFilterUpdate")),!1}</script>
